[Documents](../../Documents)

## 電子密度マップ・ボリュームデータ
この項では，電子密度マップなどのボリュームデータの表示方法について詳しく解説します．
以下ではX線結晶構造解析で扱う電子密度マップを例として挙げていますが，電子顕微鏡解析の結果得られる密度マップや静電ポテンシャルマップなどでも同様の表示が可能です．

## 表示範囲の制限
電子密度の表示範囲の制限方法としては，チュートリアル[電子密度](../../Documents/GUIのチュートリアル(CueMol2)/StepC2)にあるようにextentを指定して希望する部分のみ出すことができますが，
この方法だと範囲指定は立方体にしかできないため，微調整が困難です（例えば視界手前にあるノイズを出したくない等々）．

### 準備
例として，Lysozyme 1QIO；1qio_map_coeffs.mtz（CCP4 MTZ形式）を用います．
(サンプルファイルは以下から取得可:
[zip format](http://downloads.sourceforge.net/project/cuemol/sample-files/2.0.0/1qio_map_coeffs.zip)
ただし圧縮されているので適当なソフトウェアで解凍して使用して下さい)

PDBから1QIOを取得しsimple表示させたうえで，上記のmtzファイルを読み込んで電子密度を表示させてください．
詳しくはチュートリアル[電子密度](../../Documents/GUIのチュートリアル(CueMol2)/StepC2)を参照してください．

そして，A63 Trp残基(A.63.*)の周囲の電子密度を表示させます．
extentやslabを調節すると以下の図のようになりますが，Trp残基の電子密度全てが出るように，かつ周囲の残基の電子密度を表示しないようにするのはほぼ不可能です．

![denmap_restr1](../../assets/images/cuemol2/DensityMap/denmap_restr1.png){ .on-glb }


### 指定部分の周囲のみ表示
そこで，以下のようにcontourレンダラーのプロパティーを設定することで，
選択部分の周囲に限定して電子密度を表示させることができます．

下図のようにMapタブを選択すると電子密度表示の設定が表示されます．
Limit display byという項目がdefaultではoffになっていますが，これをonにしたうえで，
囲みの中の項目を以下のように変更します．
1.  **Selection**に選択文を指定する(この場合はA.63.*を指定)
1.  **Target**に分子オブジェクトを指定する(この場合は1QIO.pdb)
1.  **Distance**に選択範囲からの距離（Å）を指定する(この場合は2.4を指定している）


> ![denmap_restr3](../../assets/images/cuemol2/DensityMap/denmap_restr3.png){ style="zoom: 0.8" .on-glb } ⇒ ![denmap_restr_ex3](../../assets/images/cuemol2/DensityMap/denmap_restr_ex3.png){ style="zoom: 0.7" .on-glb }

### 注意点
以上の方法を用いることで，作為的に電子密度のうち特定の領域付近のみ表示させることが可能になります．
そのため，Distanceの選び方には小さい値を指定しすぎないよう細心の注意が必要となります．

特に論文やプレゼンに使用する場合は，上記設定を行わない(extentのみで調整)状態のマップに比べて
表示させるべき部分に変化がないことを確認したうえで使用するなど注意してください．

## 描画中心の更新方法
以下では，上記のMapタブで表示される他の設定について解説します．

まず，**Center update**では電子密度が描画される中心の更新方法を指定します．
*  **None** 自動更新されない
*  **Automatic** 現在のviewでの視点の中心に更新される（default）
*  **Automatic(drag)** Automaticと同様だが，マウスで併進移動中でドラッグ中でも中心を更新する．必然的に動作が重くなるため広範囲の電子密度を表示させている場合には向かない設定．

図を作成する場合等は，defaultのAutomaticで中心を決めた後は，
意図せず表示中心が変更されないようにNone設定しておいた方が良いでしょう．

## 線の太さ
**Line width**は，文字通りメッシュ描画の線の太さです．ピクセル単位で指定します．

## メッシュ作成バッファーのサイズ
**Buffer size**はメッシュ作成に使用する内部バッファーのサイズを指定します．
デフォルトの100で十分な場合が多いですが，
デフォルトで不足する場合は150や200等増加させてみてください．
Density mapパレットのExtentスライダーで増やせる最大値が増加し，
より広範囲のマップが表示できるようになるはずです．